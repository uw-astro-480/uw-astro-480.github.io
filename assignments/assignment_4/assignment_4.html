<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Code development and tools" href="../../codedev/codedev.html" /><link rel="prev" title="Assignment 3: tabular data and data visualisation" href="../assignment_3/assignment_3.html" />

    <link rel="shortcut icon" href="../../_static/favicon.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Assignment 4 (extra credit): spectroscopic data reduction - ASTR 480</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles.css?v=2bccd5c4" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #242933;
  --color-code-foreground: #d8dee9;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #242933;
  --color-code-foreground: #d8dee9;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">ASTR 480</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/UW_logo.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../syllabus.html">Course description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../schedule.html">Schedule</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../lecture_notes/lecture_notes.html">Lecture notes</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Lecture notes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lecture_notes/intro_concepts/intro_concepts.html">Introductory concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lecture_notes/ccds/ccds.html">CCDs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lecture_notes/ccd_reductions/ccd_reductions.html">Basic CCD reductions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lecture_notes/photometry/photometry.html">Photometry and CCD calibrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lecture_notes/catalogue_data/catalogue_data.html">Catalogue data and SQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lecture_notes/data_visualisation/data_visualisation.html">Plotting and data visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lecture_notes/spectrographs/spectrographs.html">Spectrographs</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../arcsat/arcsat.html">ARCSAT observations</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of ARCSAT observations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../arcsat/proposals.html">ARCSAT proposals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../arcsat/observing.html">ARCSAT observing and schedule</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.apo.nmsu.edu/Telescopes/ARCSAT/" rel="noreferrer" target="_blank">ARCSAT documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../arcsat/paper.html">ARCSAT paper</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../assignments.html">Assignments</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Assignments</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../assignment_0/assignment_0.html">Assignment 0: testing the coding environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assignment_1/assignment_1.html">Assignment 1: coordinate transformations and altitude plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assignment_2/assignment_2.html">Assignment 2: CCD reductions and photometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assignment_3/assignment_3.html">Assignment 3: tabular data and data visualisation</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Assignment 4 (extra credit): spectroscopic data reduction</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../codedev/codedev.html">Code development and tools</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Code development and tools</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../codedev/setup.html">Setting up the development environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../codedev/visualisation_tools.html">Visualisation tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../codedev/plotting.html">Plotting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/uw-astro-480" rel="noreferrer" target="_blank">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jupyter.rttl.uw.edu/2025-spring-astr-480-a" rel="noreferrer" target="_blank">JupyterHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://canvas.uw.edu/courses/1799617" rel="noreferrer" target="_blank">Canvas</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.apo.nmsu.edu/Telescopes/ARCSAT/" rel="noreferrer" target="_blank">ARCSAT</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/astr-480/astr-480-sp-25/blob/main/src/assignments/assignment_4/assignment_4.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/astr-480/astr-480-sp-25/edit/main/src/assignments/assignment_4/assignment_4.md" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="assignment-4-extra-credit-spectroscopic-data-reduction">
<h1>Assignment 4 (extra credit): spectroscopic data reduction<a class="headerlink" href="#assignment-4-extra-credit-spectroscopic-data-reduction" title="Link to this heading">¶</a></h1>
<p>In this optional assignment we perform a very basic data reduction of a long-slit spectroscopic observation.</p>
<section id="assignment-link">
<h2>Assignment link<a class="headerlink" href="#assignment-link" title="Link to this heading">¶</a></h2>
<p>To start working on the assignment, accept <a class="reference external" href="https://classroom.github.com/a/Y4zh7OTB" rel="noreferrer" target="_blank">this invitation</a> which will create a private repository from the base template.</p>
</section>
<section id="assignment-description-and-grading">
<h2>Assignment description and grading<a class="headerlink" href="#assignment-description-and-grading" title="Link to this heading">¶</a></h2>
<p>This assignment is a bit different from the previous ones. Instead of implementing a series of functions, you can implement you code in any way that you like as long as it produces the outputs described below. The tests will call the function <code class="docutils literal notranslate"><span class="pre">spec_reduction.spec.spec_reduction()</span></code> with the path to the data directory with the raw data. I encourage you to write your code as a series of functions and call them from the <code class="docutils literal notranslate"><span class="pre">spec_reduction()</span></code> function, but you are free to implement the code as you like.</p>
<p>The assignment will be graded with up to 15 points. <strong>This is an extra credit assignment; it will not affect or penalise your grade if you do not attempt it.</strong></p>
<p>The following subsections describe the steps that you need to implement in your code and hints to do so. The expected outputs are highlighted in <font color='darkred'>red</font>.</p>
</section>
<section id="dataset">
<h2>Dataset<a class="headerlink" href="#dataset" title="Link to this heading">¶</a></h2>
<p>The dataset for this assignment can be downloaded from <a class="reference external" href="https://faculty.washington.edu/gallegoj/astr480/spec_data.tar.bz2" rel="noreferrer" target="_blank">this link</a>. The dataset includes a flat field frame, an arc, and a science observation of a star. The flat is already bias-subtracted and normalised, the arc is also ready to use; the science observation is bias subtracted but not flat corrected.</p>
<p>All the data was taken using the Gemini-GMOS long-slit spectrograph. The data was taken from <a class="reference external" href="https://astro.dur.ac.uk/~knpv27/pg_dr_course/pg_dr_spectroscopy.html" rel="noreferrer" target="_blank">this</a> course. You are welcome to read the description there and their lecture notes but note that the data reduction described there is more complex and they use <a class="reference external" href="https://iraf-community.github.io" rel="noreferrer" target="_blank">IRAF</a> to do the data reduction.</p>
</section>
<section id="flat-correct-the-science-observation-and-determine-the-aperture-size">
<h2>Flat-correct the science observation and determine the aperture size<a class="headerlink" href="#flat-correct-the-science-observation-and-determine-the-aperture-size" title="Link to this heading">¶</a></h2>
<p>Start by having a look at the <code class="docutils literal notranslate"><span class="pre">b_std.fits</span></code> file (the science observation of the standard) using DS9 or plotting it in Python. Play with the stretch and intervals a bit. Which one is the wavelength direction and which one is the slit direction? Note that the image is taken by combining three CCD detectors and there are two small gaps between them.</p>
<p>The science image is bias subtracted so we only need to correct it for the flat field. To do this, you will need to divide the science image by the flat field image, which is already normalised (you can confirm this by taking a median or bias to the image).</p>
<p>Next we want to determine the aperture to use. Since this is an observation of a point source, we do not need the entire slit range, and doing so would add to the noise. Take a cut along the slit direction and use at least 50-100 columns along the wavelength direction (make sure you don’t include the gaps between the CCDs). Collapse this 2D array using a mean and create a 1D vector along the slit direction. Plot the resulting vector. It should look like a Gaussian and should tell you the range of slit pixels to use for the extraction.</p>
<p>For extra-extra grade you can fit a 1D Gaussian to the resulting vector and determine the aperture size as 3 times the standard deviation of the Gaussian. Otherwise, you can determine the aperture size by eye. <font color='darkred'>Save a plot with filename <code class="docutils literal notranslate"><span class="pre">aperture_size.png</span></code> that shows the 1D vector along the slit direction.</font> If you have fit a Gaussian, overplot the Gaussian fit. Otherwise, use two vertical lines to indicate the aperture size that you will use.</p>
<p><a class="reference internal" href="../../_images/aperture_size.png"><img alt="Standard star aperture size" class="align-center" src="../../_images/aperture_size.png" style="width: 80%;" /></a></p>
<p>Now extract the aperture from the science image. Use the entire wavelength range but only the pixels in the slit direction that you determined above. Collapse the slit direction by taking a mean (you can use something more sophisticated like a sigma-clipped median if you want). <font color='darkred'>Save the resulting 1D spectrum in a file called <code class="docutils literal notranslate"><span class="pre">b_std_aperture.fits</span></code>.</font> You can create this file using <code class="docutils literal notranslate"><span class="pre">PrimaryHDU</span></code> as usual; the data will just be a 1D array.</p>
</section>
<section id="wavelength-calibration">
<h2>Wavelength calibration<a class="headerlink" href="#wavelength-calibration" title="Link to this heading">¶</a></h2>
<p>Now we will switch to using the <code class="docutils literal notranslate"><span class="pre">arc.fits</span></code> file. This file contains the arc spectrum, which is a 2D image with the same dimensions as the science observation but in which the slit was illuminated with a lamp that produces a series of emission lines at known wavelengths. The arc spectrum is already bias subtracted and flat corrected.</p>
<p>Read the arc file and extract the same aperture as your did for the science image. Collapse it into a 1D spectrum as you did for the science observation. <font color='darkred'>Plot the resulting spectrum as <code class="docutils literal notranslate"><span class="pre">arc_aperture.png</span></code></font> (use a line plot for this). You should see a series of peaks corresponding to the emission lines in the arc spectrum, but you will also notice that there is a significant continuum in the spectrum.</p>
<p>Let’s measure and subtract that continuum. First, normalise the spectrum by dividing it by its median value, otherwise the next steps won’t work well. Next, let’s determine the continuum. You can use the tool function <code class="docutils literal notranslate"><span class="pre">spec_reduction.tools.fit_continuum_spline</span></code> which will fit a <a class="reference external" href="https://en.wikipedia.org/wiki/Spline_(mathematics)" rel="noreferrer" target="_blank">spline</a> function to the spectrum. This is a form of smoothing your spectrum to remove the contributions from the emission lines. Read the docstring of the function to understand how to use it. In particular you will need to provide good values for <code class="docutils literal notranslate"><span class="pre">median_filter</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span></code>, and <code class="docutils literal notranslate"><span class="pre">k</span></code>. The <code class="docutils literal notranslate"><span class="pre">median_filter</span></code> is used to smooth the spectrum before fitting the spline, <code class="docutils literal notranslate"><span class="pre">s</span></code> is the spline smoothing parameter that controls how much the spline will fit the data, and <code class="docutils literal notranslate"><span class="pre">k</span></code> is the degree of the spline (you can use 3 but probably you’ll want something higher). Additionally you can pass a mask to ignore some values (for example the gaps between the CCDs); this must be a boolean list or array in which the pixels that you want to ignore are set to <code class="docutils literal notranslate"><span class="pre">False</span></code>. The function will return a 1D array with the continuum values.</p>
<p>The goal is to produce a continuum that fits the shape of the spectrum will enough but that doesn’t include the emission line or the gaps between the CCDs. You’ll need to play with the parameters to get a good fit (most likely you’ll want a large-ish value for <code class="docutils literal notranslate"><span class="pre">median_filter</span></code> and <code class="docutils literal notranslate"><span class="pre">s</span></code>). Then plot the normalised arc spectrum and the continuum on top of it (use a different colour so that it’s clear what the continuum is). <font color='darkred'>Save this plot as <code class="docutils literal notranslate"><span class="pre">arc_continuum.png</span></code>.</font> Play with the parameters until you get a fit for the continuum that you are happy with.</p>
<p><a class="reference internal" href="../../_images/arc_spectrum.png"><img alt="Arc spectrum and continuum" class="align-center" src="../../_images/arc_spectrum.png" style="width: 80%;" /></a></p>
<p>Now subtract the continuum from the normalised arc spectrum. This will leave you with a spectrum that has only the emission lines and has a fairly flat shape. <font color='darkred'>Plot this spectrum in a file called <code class="docutils literal notranslate"><span class="pre">arc_aperture_no_continuum.png</span></code>.</font></p>
<p>We want to find emission lines in that plot. For that you can use the function <code class="docutils literal notranslate"><span class="pre">spec_reduction.tools.find_peaks</span></code> which will find the indices of the peaks in the spectrum. Read the docstring to understand how to use it. The main parameter to play with is <code class="docutils literal notranslate"><span class="pre">threshold</span></code> which defines how many standard deviations above the mean a peak must be to be considered a peak.</p>
<p>Plot the arc spectrum with the peak positions overplotted. Use a marker to indicate the peaks, ideally at a position above the peaks that makes them clearly visible. <font color='darkred'>Save this plot as <code class="docutils literal notranslate"><span class="pre">arc_peaks.png</span></code>.</font>.</p>
<p><a class="reference internal" href="../../_images/arc_spectrum_peaks.png"><img alt="Identified peaks in the arc spectrum" class="align-center" src="../../_images/arc_spectrum_peaks.png" style="width: 80%;" /></a></p>
<p>The next step is to match the peaks that you have found to known wavelengths in the arc spectrum. For that you can use the arc map that is provided in <code class="docutils literal notranslate"><span class="pre">CuArB600_430.pdf</span></code> or the list of wavelength positions in <code class="docutils literal notranslate"><span class="pre">CuAr_GMOS.dat</span></code>. <strong>Note that the spectrum from the CCD file decreases in wavelength as the pixel direction increases, so you’ll want to reverse the x-axis!</strong> Look at the arc spectrum and the identified peaks and try to match them to the know wavelengths. You’ll need at least 10 lines well distributed across the wavelength range, but 15 or 20 is better. Create a list or dataframe with the array indices and the corresponding wavelengths. <font color='darkred'>Save this tables as <code class="docutils literal notranslate"><span class="pre">arc_matched_lines.csv</span></code>.</font>.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Matching the peaks to the known wavelengths can be tricky. Make sure that you have reversed the x-axis direction of the arc spectrum before comparing it to the lines in the CuAr (Copper-Argon) arc map. You’ll probably want to show the arc spectrum in an interactive plot or save it in a figure with a long horizontal axis so that you can see the peaks clearly.</p>
<p>Start by identifying the tallest peaks and matching them to the known wavelengths. That will give you a good starting point. Then identify more lines using the tallest peaks as a reference. Sometimes the relative heights of the peaks may not match exactly what you see in your plot. When you have enough lines, plot your results. If one or more points look like outliers you may have made a mistake in the matching. Review your assignments and. if necessary, reject some of the lines.</p>
</div>
<p>Now let’s find the wavelength solution. This is the transformation between the pixel indices and wavelengths, and it is the same for the science observation as long as the arc was taken soon before or after that exposure. Plot the pixel indices for your identified lines in the x axis against their wavelengths in the y axis. You should see see a mostly linear relationship, but it may not be perfect. Fit a polynomial to the data using <code class="docutils literal notranslate"><span class="pre">numpy.polyfit</span></code> or <code class="docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit</span></code>. You can use a linear fit (degree 1), a quadratic fit (degree 2), or something higher depending on how well it fits the data, but do not overfit. <font color='darkred'>Plot the resulting fit on top of the data points, annotate the plot, and save it as <code class="docutils literal notranslate"><span class="pre">wavelength_solution.png</span></code>.</font>. Make sure you change the title of the plot to the fit you have found, in the form <code class="docutils literal notranslate"><span class="pre">y=a0</span> <span class="pre">+</span> <span class="pre">a1*x</span> <span class="pre">+</span> <span class="pre">a2*x^2</span> <span class="pre">+</span> <span class="pre">...</span></code> where <code class="docutils literal notranslate"><span class="pre">a0</span></code>, <code class="docutils literal notranslate"><span class="pre">a1</span></code>, <code class="docutils literal notranslate"><span class="pre">a2</span></code>, etc. are the coefficients of the polynomial fit. The following plot shows an example of using a linear fit. You’ll want to identify a few more lines that this and make sure you cover the entire wavelength range of the arc spectrum.</p>
<p><a class="reference internal" href="../../_images/arc_wavelength_fit.png"><img alt="Wavelength solution" class="align-center" src="../../_images/arc_wavelength_fit.png" style="width: 80%;" /></a></p>
</section>
<section id="wavelength-calibration-of-the-science-observation">
<h2>Wavelength calibration of the science observation<a class="headerlink" href="#wavelength-calibration-of-the-science-observation" title="Link to this heading">¶</a></h2>
<p>Let’s go back to the science observation. We will now apply the wavelength solution that we found above to the science observation. Start by reading the <code class="docutils literal notranslate"><span class="pre">b_std_aperture.fits</span></code> file that you created earlier. Now plot that spectrum but with the x axis in wavelength units (Angstroms or nanometres) instead of pixel indices. Use the wavelength solution fit that you have just found. <font color='darkred'>Save this plot as <code class="docutils literal notranslate"><span class="pre">b_std_wavelength.png</span></code>.</font>.</p>
<p><a class="reference internal" href="../../_images/std_spectrum.png"><img alt="Standard star spectrum" class="align-center" src="../../_images/std_spectrum.png" style="width: 80%;" /></a></p>
<p>This is the spectrum of the standard star BD+28 4211. You can see its calibrated spectrum <a class="reference external" href="https://www.eso.org/sci/observing/tools/standards/spectra/bd28d4211.html" rel="noreferrer" target="_blank">here</a>. Does it look like the spectrum you got? In what ways yes or not? This star has an spectral type O which has a strong continuum in the blue. Why is that not our case? Why are calibration stars important in long-slit spectroscopy? <font color='darkred'>Print your answers to these questions in the code so that when the spec_reduction() function is executed the text is output.</font></p>
</section>
<section id="deadline">
<h2>Deadline<a class="headerlink" href="#deadline" title="Link to this heading">¶</a></h2>
<p>The assignment is due on Tuesday, June 10th at 11:59 PM. Late submissions by up to 24 hours will be penalized by 20% of the total points.</p>
</section>
<section id="hints-and-resources">
<h2>Hints and resources<a class="headerlink" href="#hints-and-resources" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Remember to set up a virtual environment for your project using <code class="docutils literal notranslate"><span class="pre">uv</span> <span class="pre">sync</span></code> and activate it using <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">.venv/bin/activate</span></code>.</p></li>
<li><p>You can use any libraries that you want in this project. In particular you may want to use <a class="reference external" href="https://specutils.readthedocs.io/en/stable/" rel="noreferrer" target="_blank">specutils</a>, which implements some of the functionality that you will need for this assignment. However, note that <code class="docutils literal notranslate"><span class="pre">specutils</span></code> is better suited to work with an already calibrated 1D spectrum. You will need to do some creative use of the classes there to allow it to work with an uncalibrated spectrum.</p></li>
<li><p>Make sure to check the expected inputs and outputs of each function in the docstring. Do not change the function names or the argument that they accept or the automated tests will not work.</p></li>
<li><p>The automated tests (which you can run doing <code class="docutils literal notranslate"><span class="pre">pytest</span></code> from the root of your repository) will check that your functions are returning values with the expected format and type, but will not check that you are correctly implementing the methods. Be critical of the files that you are producing at each step.</p></li>
<li><p>Please, <strong>write comments in your code</strong>. Comments are critical to understanding any piece of code (good code should be at least 30% comments) and if your code doesn’t fully work the comments can help us understand your thought process and what you wanted to achieve.</p></li>
<li><p>Always annotate your plots with titles, axis labels, and legends where appropriate. This is important for understanding the plots and for grading.</p></li>
<li><p>You can commit Jupyter Notebooks that you used to develop your code as long as you do so in the <code class="docutils literal notranslate"><span class="pre">notebooks/</span></code> folder. You won’t be able to commit them anywhere else. If you code implementation fails we will check that folder to see if you have any Jupyter Notebooks that can help us understand your thought process and what you wanted to achieve.</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../../codedev/codedev.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Code development and tools</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../assignment_3/assignment_3.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Assignment 3: tabular data and data visualisation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025-, José Sánchez-Gallego
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/uw-astro-480/uw-astro-480.github.io/" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Assignment 4 (extra credit): spectroscopic data reduction</a><ul>
<li><a class="reference internal" href="#assignment-link">Assignment link</a></li>
<li><a class="reference internal" href="#assignment-description-and-grading">Assignment description and grading</a></li>
<li><a class="reference internal" href="#dataset">Dataset</a></li>
<li><a class="reference internal" href="#flat-correct-the-science-observation-and-determine-the-aperture-size">Flat-correct the science observation and determine the aperture size</a></li>
<li><a class="reference internal" href="#wavelength-calibration">Wavelength calibration</a></li>
<li><a class="reference internal" href="#wavelength-calibration-of-the-science-observation">Wavelength calibration of the science observation</a></li>
<li><a class="reference internal" href="#deadline">Deadline</a></li>
<li><a class="reference internal" href="#hints-and-resources">Hints and resources</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=df1a032d"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    </body>
</html>