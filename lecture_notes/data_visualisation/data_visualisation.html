<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Spectrographs" href="../spectrographs/spectrographs.html" /><link rel="prev" title="Catalogue data and SQL" href="../catalogue_data/catalogue_data.html" />

    <link rel="shortcut icon" href="../../_static/favicon.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Plotting and data visualisation - ASTR 480</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles.css?v=2bccd5c4" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #242933;
  --color-code-foreground: #d8dee9;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #242933;
  --color-code-foreground: #d8dee9;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">ASTR 480</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/UW_logo.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../syllabus.html">Course description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../schedule.html">Schedule</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../lecture_notes.html">Lecture notes</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Lecture notes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro_concepts/intro_concepts.html">Introductory concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ccds/ccds.html">CCDs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ccd_reductions/ccd_reductions.html">Basic CCD reductions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../photometry/photometry.html">Photometry and CCD calibrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalogue_data/catalogue_data.html">Catalogue data and SQL</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Plotting and data visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spectrographs/spectrographs.html">Spectrographs</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../arcsat/arcsat.html">ARCSAT observations</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of ARCSAT observations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../arcsat/proposals.html">ARCSAT proposals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../arcsat/observing.html">ARCSAT observing and schedule</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.apo.nmsu.edu/Telescopes/ARCSAT/" rel="noreferrer" target="_blank">ARCSAT documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../arcsat/paper.html">ARCSAT paper</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../assignments/assignments.html">Assignments</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Assignments</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../assignments/assignment_0/assignment_0.html">Assignment 0: testing the coding environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../assignments/assignment_1/assignment_1.html">Assignment 1: coordinate transformations and altitude plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../assignments/assignment_2/assignment_2.html">Assignment 2: CCD reductions and photometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../assignments/assignment_3/assignment_3.html">Assignment 3: tabular data and data visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../assignments/assignment_4/assignment_4.html">Assignment 4 (extra credit): spectroscopic data reduction</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../codedev/codedev.html">Code development and tools</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Code development and tools</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../codedev/setup.html">Setting up the development environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../codedev/visualisation_tools.html">Visualisation tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../codedev/plotting.html">Plotting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/uw-astro-480" rel="noreferrer" target="_blank">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://jupyter.rttl.uw.edu/2025-spring-astr-480-a" rel="noreferrer" target="_blank">JupyterHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://canvas.uw.edu/courses/1799617" rel="noreferrer" target="_blank">Canvas</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.apo.nmsu.edu/Telescopes/ARCSAT/" rel="noreferrer" target="_blank">ARCSAT</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/astr-480/astr-480-sp-25/blob/main/src/lecture_notes/data_visualisation/data_visualisation.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/astr-480/astr-480-sp-25/edit/main/src/lecture_notes/data_visualisation/data_visualisation.md" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="plotting-and-data-visualisation">
<span id="data-visualisation"></span><h1>Plotting and data visualisation<a class="headerlink" href="#plotting-and-data-visualisation" title="Link to this heading">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can download this lecture as <a class="reference download internal" download="" href="../../_downloads/d4d061b92d162b1cdbe36dd08fc701fe/data_visualisation.ipynb"><code class="xref download myst-nb docutils literal notranslate"><span class="pre">data_visualisation.ipynb</span></code></a> or <a class="reference download internal" download="" href="../../_downloads/59a2db04cec17f9ed091165b846682ae/data_visualisation.md"><code class="xref download docutils literal notranslate"><span class="pre">data_visualisation.md</span></code></a> and follow along.</p>
</div>
<p>Being able to efficiently organise and visualise data is a critical part of the data analysis process. In previous sections we have used plotting to display images and other types of data. Here we will look into the theory and technical details for effective data visualisation.</p>
<p>Let’s start with a <a class="reference external" href="https://en.wikipedia.org/wiki/Data_and_information_visualization" rel="noreferrer" target="_blank">definition</a>: <em>data visualisation is the practice of designing and creating graphic or visual representations of a large amount of complex quantitative and qualitative data and information with the help of static, dynamic or interactive visual items.</em> This definition touches on some of the key elements of data visualisation:</p>
<ul class="simple">
<li><p>Data visualisation is the process of transforming large, complex data into visual elements that are easy to comprehend.</p></li>
<li><p>Data visualisation is intimately related to <em>dimensionality reduction</em>. From a set of complex, multi-variable data, data visualisation can help understand the key underlying trends by removing or collapsing some of the dimensions.</p></li>
<li><p>Data visualisation does not only include traditional static “plots”, but also dynamic visualisations (e.g., videos or simulations) and interactive elements.</p></li>
</ul>
<p>Let’s look at a simple example of data visualisation in astronomy. The <a class="reference external" href="https://www.sdss4.org/surveys/boss/" rel="noreferrer" target="_blank">BOSS project</a> is a part of the Sloan Digital Sky Survey that for year has been determining the distance to galaxies in the local Universe via redshift measurements. The result is a “table” of millions of those measurements that include the distance to the galaxy and the position on the sky (for example, in Galactic coordinates with respect to the plane of the Galaxy). Such a dataset is very hard for any person to digest and understand. However, when we plot the data correctly we can see that there is a lot of information that would have been easy to miss without a proper visualisation.</p>
<p><a class="reference internal" href="../../_images/boss-galaxy-map.png"><img alt="BOSS data visualisation" class="align-center" src="../../_images/boss-galaxy-map.png" style="width: 80%;" /></a></p>
<p>This visualisation shows the density of galaxies in the local Universe in a polar plot, with the radial direction representing the distance to the galaxies (as redshift) and the other the Galactic longitude. We immediately see that the galaxies are not uniformly distributed, but instead form a series of “tendrils” and “voids” that correspond to the large-scale structure of the Universe (these include groups, clusters and superclusters of galaxies). Note that in choosing how to plot the data we have made a decision on what variables to display: for example we could have plotted the data in cartesian coordinates as a 3D plot using both the Galactic longitude and latitude, but that would have made the plot harder to read and interpret.</p>
<section id="types-of-plots">
<h2>Types of plots<a class="headerlink" href="#types-of-plots" title="Link to this heading">¶</a></h2>
<p>Let’s now discuss different types of plots and how to choose the right one to visualise your data. This section is heavily based, and uses many plots, from the excellent <a class="reference external" href="https://seaborn.pydata.org/tutorial.html" rel="noreferrer" target="_blank">seaborn tutorials</a>, which we will use often to generate our plots. <a class="reference external" href="https://seaborn.pydata.org/" rel="noreferrer" target="_blank">seaborn</a> is a plotting library that build on top of <a class="reference external" href="https://matplotlib.org/" rel="noreferrer" target="_blank">matplotlib</a> and provides a high-level interface for drawing attractive statistical graphics.</p>
<p>We will start by having a look at the different types of variables that we may encounter in our data. As we discuss different kinds of plots it will became obvious how they are associated to different types of variables. Variables can be classified in three main groups:</p>
<ul class="simple">
<li><p>A <em>discrete variable</em> can only take certain values out of a (potentially) infinite range. E.g., natural numbers, number of pets in a household, photons received, etc.</p></li>
<li><p>A <em>continuous variable</em> can take any value in an infinite range. E.g., real numbers, height, mass, voltage, etc.</p></li>
<li><p>A <em>categorical variable</em> can take a (limited) number of values that are not necessarily numerical. E.g., months, male/female/non-binary, yes/no.</p></li>
</ul>
<p><a class="reference internal" href="../../_images/types-variables.png"><img alt="Types of variables" class="align-center" src="../../_images/types-variables.png" style="width: 90%;" /></a></p>
<section id="scatter-plots">
<h3>Scatter plots<a class="headerlink" href="#scatter-plots" title="Link to this heading">¶</a></h3>
<p>Scatter plots highlight the relationship between two or more continuous variables for which we have specific measurements (for example from lab experiments). For example, we may have a database that tracks the tip left by a client in a restaurant and the total bill. We can then plot the tip against the bill to see if there is a correlation between the two variables.</p>
<p><a class="reference internal" href="../../_images/scatter-plot.png"><img alt="Scatter plot" class="align-center" src="../../_images/scatter-plot.png" style="width: 60%;" /></a></p>
<p>Additional categorical variables can be added to the plot by using different colours or shapes for the points (markers). For example, we could use different colours (hue, as we’ll see later) to represent the type of restaurant (e.g., fast food, fine dining, etc.) or the day of the week, if that information is available in our dataset.</p>
</section>
<section id="line-plots">
<h3>Line plots<a class="headerlink" href="#line-plots" title="Link to this heading">¶</a></h3>
<p>Line plots are used to highlight the continuous relationship between two variables. At its core they are just a scatter plot with the points connected by a line, but they are particularly useful for showing trends in the data. In the following plot with see the evolution of the price of a stock over time.</p>
<p><a class="reference internal" href="../../_images/line-plot.png"><img alt="Line plot" class="align-center" src="../../_images/line-plot.png" style="width: 60%;" /></a></p>
<p>As in the case of scatter plots, we can use different line colours or styles (e.g., dashed, dotted) to represent additional categorical variables or to highlight specific trends in the data. We can also use shaded regions or error bars to represent the uncertainty in the measurements or the confidence intervals of the data.</p>
<p><a class="reference internal" href="../../_images/line-plot-hue.png"><img alt="Line plot with error bars" class="align-center" src="../../_images/line-plot-hue.png" style="width: 60%;" /></a></p>
</section>
<section id="histograms-and-kde">
<h3>Histograms and KDE<a class="headerlink" href="#histograms-and-kde" title="Link to this heading">¶</a></h3>
<p>A histogram plots (or bin plots) is a representation of the distribution of a discrete or continuous variable. On the x-axis we have the possible values of the variable (either the values the variable can take in the case of a discrete variable, or a series of “bins” in the case of a continuous variable) and on the y-axis we have the number of occurrences of each value (or bin). Histograms can also represent the probability distribution of a variable.</p>
<p><a class="reference internal" href="../../_images/hist-plot.png"><img alt="Histogram" class="align-center" src="../../_images/hist-plot.png" style="width: 60%;" /></a></p>
<p>Histograms are critical to understand and explain the scope of our data. A good advice is always to start with a histogram of the data you are working with, as it will give you a good idea of the distribution of the variable (for example, is it a flat distribution, peaked, bimodal, etc.).</p>
<p>Another way to represent the distribution of a continuous variable is to use a <a class="reference external" href="https://en.wikipedia.org/wiki/Kernel_density_estimation" rel="noreferrer" target="_blank">kernel density estimate (KDE)</a>. A KDE is a smoothed version of the histogram that uses a kernel function (usually a Gaussian) to estimate the probability density function of the variable. The result is a continuous curve that represents the distribution of the variable. KDE plots are useful to highlight the main feature of a distribution. For example, in the previous histogram the data seems to have a bimodal distribution, but this is shown much more clearly in the KDE plot below.</p>
<p><a class="reference internal" href="../../_images/kde-plot.png"><img alt="KDE plot" class="align-center" src="../../_images/kde-plot.png" style="width: 60%;" /></a></p>
</section>
<section id="bar-plots">
<h3>Bar plots<a class="headerlink" href="#bar-plots" title="Link to this heading">¶</a></h3>
<p>Bar plots are used to represent values associated with a categorical or discrete variable. One axis represents the categories and the y-axis represents the associated value for each category. Bar plots are similar to histograms but they are not limited to representing the distribution of a variable. In the example below we have a categorical variable (the states of the US) and associated values (automobile collisions per billion of miles driven). We can use different colours to represent additional variables, for example the number of those collisions caused by alcohol consumption.</p>
<p><a class="reference internal" href="../../_images/bar-plot.png"><img alt="Bar plot" class="align-center" src="../../_images/bar-plot.png" style="width: 60%;" /></a></p>
</section>
<section id="bivariate-distributions">
<h3>Bivariate distributions<a class="headerlink" href="#bivariate-distributions" title="Link to this heading">¶</a></h3>
<p>Bivariate distribution plots are similar to histograms, but in this case we have two continuous or discrete variables. The result is a 2D plot in which for each pair of values or bins we show the number of occurrences or the probability density using a colour scale. 2D histograms are very useful to understand data in visualisations where scatter plots hide the “density” of our distribution. We wil see an example of this later in this section.</p>
<p><a class="reference internal" href="../../_images/hist-2d-plot.png"><img alt="Bivariate histogram" class="align-center" src="../../_images/hist-2d-plot.png" style="width: 60%;" /></a></p>
<p>As in the case of univariate histograms, we can use a KDE to represent the bivariate distribution. The result is what is sometimes called a “contour plot”, which shows the density of the data in a 2D space. The contour lines represent the regions of equal density.</p>
<p><a class="reference internal" href="../../_images/kde-2d-plot.png"><img alt="Bivariate KDE" class="align-center" src="../../_images/kde-2d-plot.png" style="width: 60%;" /></a></p>
</section>
<section id="violin-and-box-plots">
<h3>Violin and box plots<a class="headerlink" href="#violin-and-box-plots" title="Link to this heading">¶</a></h3>
<p>Violin and box plots are used to represent the distribution of a continuous variable associated with a categorical variable. They are similar to histograms, but they show the distribution of the variable for each category. Violin plots are similar to KDE plots, but they show the distribution of the variable for each category. Box plots are a simplified version of violin plots that show the median, quartiles and outliers of the distribution.</p>
<p><a class="reference internal" href="../../_images/violin-plot.png"><img alt="Violin plot" class="align-center" src="../../_images/violin-plot.png" style="width: 60%;" /></a></p>
<p><a class="reference internal" href="../../_images/box-plot.png"><img alt="Box plot" class="align-center" src="../../_images/box-plot.png" style="width: 60%;" /></a></p>
<p>Violin and box plots pack a lot of information and can sometimes be hard to read, but they are useful to quickly summarise all the main feature of a distribution.</p>
</section>
<section id="multigrid-plots">
<h3>Multigrid plots<a class="headerlink" href="#multigrid-plots" title="Link to this heading">¶</a></h3>
<p>Multigrid plots show the relationship between a set of variables. They are useful to understand the correlations between the different variables in a dataset. There are many types of multigrid plots; the following one shows the pairwise relationships between the different components of a flower. The diagonal shows the distribution of each variable as a KDE plot.</p>
<p><a class="reference internal" href="../../_images/multigrid-plot.png"><img alt="Multigrid plot" class="align-center" src="../../_images/multigrid-plot.png" style="width: 60%;" /></a></p>
</section>
<section id="images">
<h3>Images<a class="headerlink" href="#images" title="Link to this heading">¶</a></h3>
<p>Images are a special case of 2D histogram in which for each element in a regular 2D grid (you can think of these as “pixels”) we represent the value of the image at that spatial position. In a raw CCD image this would be the number of electrons/photons detected at that pixel. As we will see below, it’s important to think about the limits and stretch of the data we are visualising.</p>
</section>
</section>
<section id="colours-and-palettes">
<h2>Colours and palettes<a class="headerlink" href="#colours-and-palettes" title="Link to this heading">¶</a></h2>
<p>So far we have referred loosely to the concept of “colour” in our plots. Colour, in the data visualisation context, is defined by three elements:</p>
<ul class="simple">
<li><p><em>Hue</em>: quality of light that distinguishes between different colours.</p></li>
<li><p><em>Saturation</em>: amount of hue present in a colour.</p></li>
<li><p><em>Luminance</em>: how dark/light a colour is.</p></li>
</ul>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../../_images/hue.png"><img alt="Hue" class="align-center" src="../../_images/hue.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-text">Hue</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="../../_images/saturation.png"><img alt="Saturation" class="align-center" src="../../_images/saturation.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-text">Saturation</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="../../_images/luminance.png"><img alt="Luminance" class="align-center" src="../../_images/luminance.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-text">Luminance</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>As a general rule we use different hues to represent different categorical variables, while we use saturation and luminance to represent continuous variables. For example, in this two scatter plots we are representing the same data. On the left we use markers to differentiate between to types of data points (categorical variable), while on the right we use additionally change the hue of the markers. It’s clear that the right plot makes the different variables much more distinguishable.</p>
<p><a class="reference internal" href="../../_images/scatter-hue.png"><img alt="Scatter plot with hue" class="align-center" src="../../_images/scatter-hue.png" style="width: 60%;" /></a></p>
<p>Similarly, we can plot a 2D histogram using different hues to represent the density of the data as we do on the left panel in the following plot. Even with a colour bar that associates hues to numerical values it’s hard to visually correlate those two parameters. On the right we use a different colour palette that uses saturation to represent the density of the data, which makes it much easier to read.</p>
<p><a class="reference internal" href="../../_images/hist-2d-luminance.png"><img alt="2D histogram with luminance" class="align-center" src="../../_images/hist-2d-luminance.png" style="width: 60%;" /></a></p>
<p>The range of colours that we use to represent our data is called a <em>colour palette</em>. Different colour palettes are better suited for different types of data. For discrete variables, as we saw before, we prefer a palette in which the hue changes, thus highlighting the different categories. This type of palette is called a <em>qualitative palette</em> or <em>discrete palette</em>.</p>
<p><a class="reference internal" href="../../_images/discrete-palette.png"><img alt="Qualitative palette" class="align-center" src="../../_images/discrete-palette.png" style="width: 60%;" /></a></p>
<p>For continuous variables, we prefer a palette in which the hue remains constant and the saturation and luminance change, thus highlighting the different values of the variable. This type of palette is called a <em>sequential palette</em>.</p>
<p><a class="reference internal" href="../../_images/sequential-palette.png"><img alt="Sequential palette" class="align-center" src="../../_images/sequential-palette.png" style="width: 60%;" /></a></p>
<p>When we have a continuous variable that can take both positive and negative values, we need to use a different type of palette. In this case we want to highlight the two extremes (positive and negative) using different hues, while keeping the saturation and luminance constant. This type of palette is called a <em>diverging palette</em>.</p>
<p>For data that has both positive and negative values, or a clear tipping point, we use a <em>diverging palette</em> that uses two different hues to represent the two extremes.</p>
<p><a class="reference internal" href="../../_images/diverging-palette.png"><img alt="Diverging palette" class="align-center" src="../../_images/diverging-palette.png" style="width: 60%;" /></a></p>
<p>Choosing the right palette is critical to make our plots readable and understandable. Matplotlib and seaborn provide a wide range of colour palettes that can be used in our plots. You can find a list of the available palettes in the <a class="reference external" href="https://seaborn.pydata.org/tutorial/color_palettes.html" rel="noreferrer" target="_blank">seaborn documentation</a> and in the <a class="reference external" href="https://matplotlib.org/stable/tutorials/colors/colormaps.html" rel="noreferrer" target="_blank">matplotlib documentation</a>.</p>
<p>Finally, it’s important to remember that not all colours are distinguishable by all people. For example, people with colour blindness may have trouble distinguishing between certain hues. To make our plots accessible to everyone, we should use colour palettes that are friendly to colour blindness. The following image shows several discrete palettes and how they are perceived by people with different types of colour blindness (deuteranopia and protanopia).</p>
<p><a class="reference internal" href="../../_images/colour-blindness-palettes.png"><img alt="Colour blindness palettes" class="align-center" src="../../_images/colour-blindness-palettes.png" style="width: 100%;" /></a></p>
<p>A good resource to check how your plots look like for people with colour blindness is the <a class="reference external" href="https://jfly.uni-koeln.de/color/" rel="noreferrer" target="_blank">Color Universal Design (CUD) website</a>, which provides a detailed explanation of how colour blindness affects perception. This <a class="reference external" href="https://davidmathlogic.com/colorblind/" rel="noreferrer" target="_blank">page</a> also provides a good overview of the different types of colour blindness and how to make your plots accessible to everyone.</p>
</section>
<section id="displaying-astronomical-images">
<h2>Displaying astronomical images<a class="headerlink" href="#displaying-astronomical-images" title="Link to this heading">¶</a></h2>
<p>Let’s now focus on a specific type of data visualisation that is very common in astronomy: displaying astronomical images. We have already seen how to do this in previous sections and using DS9, but now we’ll introduce a few additional concepts.</p>
<p>When displaying image data we need to consider three main aspects: what range of data values we want to display (the interval), how we are mapping the data values to colours (the stretch, e.g., linear or logarithmic), and the colour palette we are using. Let’s look at these in detail with an example.</p>
<p>We will start by displaying one of our <a class="reference internal" href="../ccd_reductions/ccd_reductions.html#basic-ccd-reductions"><span class="std std-ref">reduced CCD images</span></a> using <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html" rel="noreferrer" target="_blank">matplotlib.imshow</a>. This function displays a 2D array as an image, with the values of the array mapped to colours using a colour palette.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;ccd.037.0_proc.fits&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;f4&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/411ab57639f752e21e9156c2d6c44570339cce8273faa8d33204b6c65e5a8098.png" src="../../_images/411ab57639f752e21e9156c2d6c44570339cce8273faa8d33204b6c65e5a8098.png" />
</div>
</div>
<p>We do not see a lot of detail in this image. As we commented before, it’s always a good idea to start with a histogram of the data to understand its distribution. Let’s do that now. We will use the <code class="docutils literal notranslate"><span class="pre">seaborn.histplot</span></code> function to plot the histogram of the data values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up seaborn style to make the plots look nice</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span> <span class="n">color_codes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>

<span class="c1"># Print some statistics of the data</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Min: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Max: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;First quartile: </span><span class="si">{</span><span class="n">numpy</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ninety-ninth percentile: </span><span class="si">{</span><span class="n">numpy</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="mi">99</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Min: -4465.52
Max: 58307.80
Mean: 713.19
First quartile: 690.94
Ninety-ninth percentile: 869.74
</pre></div>
</div>
<img alt="../../_images/149b63c6e594bf1677d2cc0a52afbb9cab0db95a2fd0742a80e8798cb8fddb18.png" src="../../_images/149b63c6e594bf1677d2cc0a52afbb9cab0db95a2fd0742a80e8798cb8fddb18.png" />
</div>
</div>
<p>Even when we define a hundred bins we see that most of the data values are concentrated in a very small range. The 99% percentile tells us that 99% of the data values are below 869 counts, but we have at least some values going as high as 58300 counts. Let’s redo the plot but displaying only the values below 1000 counts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_low</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data_low</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8ea3dea995ec5055e4e2fff05797668112ff8fa72370095286173c5f0fc324cd.png" src="../../_images/8ea3dea995ec5055e4e2fff05797668112ff8fa72370095286173c5f0fc324cd.png" />
</div>
</div>
<p>With this information, let’s plot the image again, but this time using some data limits, which in <code class="docutils literal notranslate"><span class="pre">imshow</span></code> with can pass using the <code class="docutils literal notranslate"><span class="pre">vmin</span></code> and <code class="docutils literal notranslate"><span class="pre">vmax</span></code> parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seaborn</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9fe9691fa66e9738bc393776ece53e79dfcb474b58ff6c0011a2eced497cf13d.png" src="../../_images/9fe9691fa66e9738bc393776ece53e79dfcb474b58ff6c0011a2eced497cf13d.png" />
</div>
</div>
<p>That’s significantly better! What we have done is to adjust the interval of the data that we are displaying. <a class="reference external" href="https://docs.astropy.org/en/stable/visualization/index.html" rel="noreferrer" target="_blank">astropy.visualization</a> provides a set of functions to help with this process, including <code class="docutils literal notranslate"><span class="pre">astropy.visualization.ImageNormalize</span></code>, which allows us to normalise the data values to a specific range.</p>
<p>There are, generally, two algorithms for data range interval: minmax and z-scale. The former simply displays all the values. The latter does something similar to what we did with the histogram but using a faster, less precise algorithm. The details can be found <a class="reference external" href="https://astro.uni-bonn.de/~sysstw/lfa_html/iraf/images.tv.display.html" rel="noreferrer" target="_blank">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">astropy.visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">ZScaleInterval</span><span class="p">,</span> <span class="n">MinMaxInterval</span>

<span class="n">zscale</span> <span class="o">=</span> <span class="n">ZScaleInterval</span><span class="p">()</span>
<span class="n">minmax</span> <span class="o">=</span> <span class="n">MinMaxInterval</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Z-scale interval: </span><span class="si">{</span><span class="n">zscale</span><span class="o">.</span><span class="n">get_limits</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Minmax interval: </span><span class="si">{</span><span class="n">minmax</span><span class="o">.</span><span class="n">get_limits</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Z-scale interval: (np.float32(624.99835), np.float64(841.6901693431514))
Minmax interval: (np.float32(-4465.523), np.float32(58307.805))
</pre></div>
</div>
</div>
</div>
<p>See how the range of values in the z-scale interval is very similar to the ones we found using the histogram. To use this interval we can create a matplotlib normalisation object and pass it to <code class="docutils literal notranslate"><span class="pre">imshow</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">astropy.visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImageNormalize</span><span class="p">,</span> <span class="n">LinearStretch</span>

<span class="n">norm</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">ZScaleInterval</span><span class="p">())</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/71e8e2b4bee9f453de068d98f02ccbeb46ff417b01a16d740029104c33dcc98f.png" src="../../_images/71e8e2b4bee9f453de068d98f02ccbeb46ff417b01a16d740029104c33dcc98f.png" />
</div>
</div>
<p>So far we have used a linear mapping between the values of the image and the colour levels (saturation and luminance). We can also use a logarithmic mapping, which is useful to highlight faint features in the image. To do this we can use the <code class="docutils literal notranslate"><span class="pre">LogStretch</span></code> class from <code class="docutils literal notranslate"><span class="pre">astropy.visualization</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">astropy.visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogStretch</span>

<span class="n">norm_log</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">ZScaleInterval</span><span class="p">(),</span> <span class="n">stretch</span><span class="o">=</span><span class="n">LogStretch</span><span class="p">())</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm_log</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/86067f6c403940cbf2a0248cfa6697236c8a626b4bb29e65ac25231f3e9810ba.png" src="../../_images/86067f6c403940cbf2a0248cfa6697236c8a626b4bb29e65ac25231f3e9810ba.png" />
</div>
</div>
<p>There are other stretches available in <code class="docutils literal notranslate"><span class="pre">astropy.visualization</span></code>, such as <code class="docutils literal notranslate"><span class="pre">SqrtStretch</span></code> and <code class="docutils literal notranslate"><span class="pre">AsinhStretch</span></code>, which can also be useful depending on the characteristics of the data being visualized.</p>
<p>Finally, let’s look at the colour palettes for visualising data. Until now we have used a simple grayscale palette, but we can use other palettes to highlight different features in the data. CCD data is typically sequential, so we will generally want to use a sequential palette. For example, we can use the <code class="docutils literal notranslate"><span class="pre">viridis</span></code> palette, which is a good choice for displaying data with a wide range of values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">ZScaleInterval</span><span class="p">(),</span> <span class="n">stretch</span><span class="o">=</span><span class="n">LinearStretch</span><span class="p">())</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f08b6300b3fbb188f2a6b05af130d44f6d0a03fe5d458fb52a65fa431f0bcc31.png" src="../../_images/f08b6300b3fbb188f2a6b05af130d44f6d0a03fe5d458fb52a65fa431f0bcc31.png" />
</div>
</div>
<p>Again, you can check all the available palettes in the <a class="reference external" href="https://matplotlib.org/stable/tutorials/colors/colormaps.html" rel="noreferrer" target="_blank">matplotlib documentation</a>. All palettes accept a <code class="docutils literal notranslate"><span class="pre">_r</span></code> suffix to reverse the colours. For example, let’s use a heat-like palette</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrBr_r&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1fa6d5a48f6765d5e8f6235e55849ff0a43727a71acff02677df39bfcc2b34db.png" src="../../_images/1fa6d5a48f6765d5e8f6235e55849ff0a43727a71acff02677df39bfcc2b34db.png" />
</div>
</div>
<section id="creating-rgb-images">
<h3>Creating RGB images<a class="headerlink" href="#creating-rgb-images" title="Link to this heading">¶</a></h3>
<p>It’s important to differentiate between monochromatic data (e.g., a single CCD image) displayed using a colour map that uses different hues, and RGB images. The latter are created by combining three or more monochromatic images, each representing a different colour channel (red, green and blue).</p>
<p>RGB images are not very common in astronomy, but they are sometimes useful to visually identify features in the data (e.g., blue vs red galaxies), and to create beautiful images of astronomical objects. Ideally, an RGB image would result in an image that the human eye would perceive as a “natural” representation of the object being observed, assuming that our eye was more sensitive. In practice there is a certain element of subjectivity and multiple algorithms exist to create RGB images from monochromatic data. Astropy has a useful page on <a class="reference external" href="https://docs.astropy.org/en/stable/visualization/rgb.html" rel="noreferrer" target="_blank">how to create RGB images</a> so we will not repeat that here.</p>
</section>
</section>
<section id="plotting-tabular-data">
<h2>Plotting tabular data<a class="headerlink" href="#plotting-tabular-data" title="Link to this heading">¶</a></h2>
<p>Let’s now switch to looking into some common plotting techniques for tabular data. We will use the dataset <code class="docutils literal notranslate"><span class="pre">all_exoplanets_2021.parquet</span></code> which contains a list of all the exoplanets discovered up to 2021, including information such as the planet’s mass, host star, discovery method and facility, etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">planets</span> <span class="o">=</span> <span class="n">polars</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;all_exoplanets_2021.parquet&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">planets</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Columns:&#39;</span><span class="p">,</span> <span class="n">planets</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>shape: (5, 23)
┌─────┬────────────┬────────────┬───────────┬───┬────────────┬────────────┬────────────┬───────────┐
│ id  ┆ planet_nam ┆ planet_hos ┆ num_stars ┆ … ┆ stellar_me ┆ stellar_su ┆ distance   ┆ gaia_magn │
│ --- ┆ e          ┆ t          ┆ ---       ┆   ┆ tallicity_ ┆ rface_grav ┆ ---        ┆ itude     │
│ i16 ┆ ---        ┆ ---        ┆ i32       ┆   ┆ ratio      ┆ ity        ┆ f32        ┆ ---       │
│     ┆ str        ┆ str        ┆           ┆   ┆ ---        ┆ ---        ┆            ┆ f32       │
│     ┆            ┆            ┆           ┆   ┆ str        ┆ f32        ┆            ┆           │
╞═════╪════════════╪════════════╪═══════════╪═══╪════════════╪════════════╪════════════╪═══════════╡
│ 1   ┆ 11 Com b   ┆ 11 Com     ┆ 2         ┆ … ┆ [Fe/H]     ┆ 2.31       ┆ 93.184601  ┆ 4.44038   │
│ 2   ┆ 11 UMi b   ┆ 11 UMi     ┆ 1         ┆ … ┆ [Fe/H]     ┆ 1.93       ┆ 125.320999 ┆ 4.56216   │
│ 3   ┆ 14 And b   ┆ 14 And     ┆ 1         ┆ … ┆ [Fe/H]     ┆ 2.63       ┆ 75.439201  ┆ 4.91781   │
│ 4   ┆ 14 Her b   ┆ 14 Her     ┆ 1         ┆ … ┆ [Fe/H]     ┆ 4.45       ┆ 17.932301  ┆ 6.383     │
│ 5   ┆ 16 Cyg B b ┆ 16 Cyg B   ┆ 3         ┆ … ┆ [Fe/H]     ┆ 4.36       ┆ 21.1397    ┆ 6.06428   │
└─────┴────────────┴────────────┴───────────┴───┴────────────┴────────────┴────────────┴───────────┘
Columns: [&#39;id&#39;, &#39;planet_name&#39;, &#39;planet_host&#39;, &#39;num_stars&#39;, &#39;num_planets&#39;, &#39;discovery_method&#39;, &#39;discovery_year&#39;, &#39;discovery_facility&#39;, &#39;orbital_period_days&#39;, &#39;orbit_semi_major_axis&#39;, &#39;mass&#39;, &#39;eccentricity&#39;, &#39;insolation_flux&#39;, &#39;equilibrium_temperature&#39;, &#39;spectral_type&#39;, &#39;stellar_effective_temperature&#39;, &#39;stellar_radius&#39;, &#39;stellar_mass&#39;, &#39;stellar_metallicity&#39;, &#39;stellar_metallicity_ratio&#39;, &#39;stellar_surface_gravity&#39;, &#39;distance&#39;, &#39;gaia_magnitude&#39;]
</pre></div>
</div>
</div>
</div>
<p>Let’s start with a very simple scatter plot in which we relate the host start effective temperature to its mass.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seaborn</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;darkgrid&#39;</span><span class="p">)</span>

<span class="c1"># Remove duplicates by keeping only the first occurrence of each host star.</span>
<span class="n">stars</span> <span class="o">=</span> <span class="n">planets</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;planet_host&#39;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">stars</span><span class="p">[</span><span class="s1">&#39;stellar_mass&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">stars</span><span class="p">[</span><span class="s1">&#39;stellar_effective_temperature&#39;</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Stellar mass ($M_</span><span class="se">\\</span><span class="s1">odot$)&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Stellar effective temperature (K)&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">12000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1dadcf69d81a8f2f5f71c5f2e4d18a640acdf0ac7945e7bb49df9aa7d7079fb3.png" src="../../_images/1dadcf69d81a8f2f5f71c5f2e4d18a640acdf0ac7945e7bb49df9aa7d7079fb3.png" />
</div>
</div>
<p>It would be interesting to see how this distribution is affected by the stellar type. The column <code class="docutils literal notranslate"><span class="pre">spectral_type</span></code> contains the spectral type of the star, including its luminosity class. We will create a new column with only the stellar type (e.g., G, K, M) and use it to colour the points in the scatter plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new column with only the stellar class</span>
<span class="n">stars</span> <span class="o">=</span> <span class="n">stars</span><span class="o">.</span><span class="n">drop_nulls</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;spectral_type&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">spectral_class</span><span class="o">=</span><span class="n">polars</span><span class="o">.</span><span class="n">col</span><span class="o">.</span><span class="n">spectral_type</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">stars</span><span class="p">[</span><span class="s1">&#39;stellar_mass&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">stars</span><span class="p">[</span><span class="s1">&#39;stellar_effective_temperature&#39;</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="n">stars</span><span class="p">[</span><span class="s1">&#39;spectral_class&#39;</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Stellar mass ($M_</span><span class="se">\\</span><span class="s1">odot$)&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Stellar effective temperature (K)&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">12000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7740699eddf0c243da0e789bb45db609c61a8f8969f14ee5dc50d3789e195253.png" src="../../_images/7740699eddf0c243da0e789bb45db609c61a8f8969f14ee5dc50d3789e195253.png" />
</div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We are using <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> functions to plot the data. These functions simplify some of the details of producing nice-looking plots, but they are ultimately built on top of <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>. All these plots can be reproduced using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> directly.</p>
</div>
<p>We will now look at the histogram of number of planets per star. This dataset includes one planet per row, including planets that orbit the same start. We need to use a group-by operation to count the number of planets per star, and then plot the result as a histogram.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Group by the host star and count the number of rows (planets) in each group</span>
<span class="n">planets_per_star</span> <span class="o">=</span> <span class="n">planets</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s1">&#39;planet_host&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">planets_per_star</span><span class="p">)</span>

<span class="c1"># Plot the histogram of number of planets per star</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">planets_per_star</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of planets per star&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>shape: (3_392, 2)
┌───────────────────┬─────┐
│ planet_host       ┆ n   │
│ ---               ┆ --- │
│ str               ┆ u32 │
╞═══════════════════╪═════╡
│ HD 181433         ┆ 3   │
│ Kepler-113        ┆ 2   │
│ Kepler-101        ┆ 2   │
│ Kepler-684        ┆ 1   │
│ MOA-2012-BLG-006L ┆ 1   │
│ …                 ┆ …   │
│ Kepler-1654       ┆ 1   │
│ Kepler-596        ┆ 1   │
│ WASP-8            ┆ 2   │
│ HIP 65 A          ┆ 1   │
│ Kepler-123        ┆ 2   │
└───────────────────┴─────┘
</pre></div>
</div>
<img alt="../../_images/3004b55bc10531530d339ced2148759ebb79543d02b7a0ed4a8a89c7ccb3e0b2.png" src="../../_images/3004b55bc10531530d339ced2148759ebb79543d02b7a0ed4a8a89c7ccb3e0b2.png" />
</div>
</div>
<p>Not unexpectedly, most stars have only one planet. Let’s look at the number of exoplanets discovered every year. We expect to see an steady increase in the number of discoveries over the years, as the technology and methods used to discover exoplanets have improved.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the histogram of number of planets discovered per year</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">planets</span><span class="p">[</span><span class="s1">&#39;discovery_year&#39;</span><span class="p">],</span> <span class="n">binwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a46801932d52dd146e1256c09c212338a029d4001bb5b67689c07cea15435eca.png" src="../../_images/a46801932d52dd146e1256c09c212338a029d4001bb5b67689c07cea15435eca.png" />
</div>
</div>
<p>Interestingly, we have huge peaks of discoveries in 2014 and 2016. These correspond to data releases of the <a class="reference external" href="https://kepler.nasa.gov/" rel="noreferrer" target="_blank">Kepler mission</a>, which discovered thousands of exoplanets in a very short period of time using transit observations. Let’s confirm this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_2014</span> <span class="o">=</span> <span class="n">planets</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">polars</span><span class="o">.</span><span class="n">col</span><span class="o">.</span><span class="n">discovery_year</span> <span class="o">==</span> <span class="mi">2014</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_2014</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s1">&#39;discovery_facility&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">len</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>shape: (21, 2)
┌─────────────────────────────────┬─────┐
│ discovery_facility              ┆ n   │
│ ---                             ┆ --- │
│ str                             ┆ u32 │
╞═════════════════════════════════╪═════╡
│ Kepler                          ┆ 781 │
│ Multiple Observatories          ┆ 22  │
│ SuperWASP                       ┆ 20  │
│ W. M. Keck Observatory          ┆ 13  │
│ La Silla Observatory            ┆ 5   │
│ …                               ┆ …   │
│ Gemini Observatory              ┆ 1   │
│ Paranal Observatory             ┆ 1   │
│ Lick Observatory                ┆ 1   │
│ K2                              ┆ 1   │
│ Okayama Astrophysical Observat… ┆ 1   │
└─────────────────────────────────┴─────┘
</pre></div>
</div>
</div>
</div>
<p>Finally, let’s have a look at the discovery method and hot it has changed over the years. We can do this directly with the <code class="docutils literal notranslate"><span class="pre">histplot</span></code> function, which allows us to group by a categorical variable (<code class="docutils literal notranslate"><span class="pre">discover_year</span></code>) and colour-code by another (<code class="docutils literal notranslate"><span class="pre">discovery_method</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">planets</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;discovery_year&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;discovery_method&#39;</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="s1">&#39;stack&#39;</span><span class="p">,</span> <span class="n">binwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d370468f37ef7936be5c34b73bb57b2eff73ac8698541e2953fcdac0a3033a75.png" src="../../_images/d370468f37ef7936be5c34b73bb57b2eff73ac8698541e2953fcdac0a3033a75.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">seaborn</span></code> generally works well with <code class="docutils literal notranslate"><span class="pre">polars</span></code> but sometimes it’s necessary to convert the dataframe to <code class="docutils literal notranslate"><span class="pre">pandas</span></code> using the <code class="docutils literal notranslate"><span class="pre">to_pandas()</span></code> method.</p>
</div>
<p>As we can see the vast majority of early exoplanets were discovered using the radial velocity method, while in recent years the transit method has become the most popular. Even more recently, we are starting to see a significant number of discoveries using microlensing.</p>
</section>
<section id="plotting-a-galaxy-colour-magnitude-diagram">
<h2>Plotting a galaxy colour-magnitude diagram<a class="headerlink" href="#plotting-a-galaxy-colour-magnitude-diagram" title="Link to this heading">¶</a></h2>
<p>We’ll finish this section with a real science example: plotting a galaxy colour-magnitude diagram (gCMD). You are probably familiar with the Hertzsprung-Russell diagram, which plots stars by their luminosity and temperature (a stellar CMD is the same but using magnitude colours as proxies for luminosity and temperature). The <a class="reference external" href="https://en.wikipedia.org/wiki/Galaxy_color%E2%80%93magnitude_diagram" rel="noreferrer" target="_blank">galaxy color-magnitude diagram</a> plots the mass of a a galaxy (usually using the absolute magnitude in the i’ or z’ bands as a proxy for stellar mass) against a colour that differentiates between blue and red galaxies (e.g., the g’-i’ colour). These diagrams started to be prouced in the early 2000s thanks to observations from the Sloan Digital Sky Survey (SDSS), which was the first survey to compile multi-band photometry for hundreds of thousands of galaxies. When a gCMD is plotted we see a clear bimodal distribution, we most galaxies belonging to one of two main populations: blue galaxies, which are actively forming stars, and red galaxies, which are mostly quiescent. Sometimes a third population of “green valley” galaxies is also identified, which are in the process of transitioning from blue to red.</p>
<p><a class="reference internal" href="../../_images/gcmd.png"><img alt="Galaxy colour-magnitude diagram" class="align-center" src="../../_images/gcmd.png" style="width: 60%;" /></a></p>
<p>The gCMD was the first indication that galaxies are not always start forming or quiescent, but that they transition from one state to the other, and that the transition is fast enough that not many galaxies fall in the “green valley”. This transition is thought to be driven by a combination of internal and external processes, such as gas accretion, exhaustion of molecular gas, and interactions with other galaxies.</p>
<p>Let’s create our own gCMD for the local Universe. We will use some data retrieved using CasJobs. For convenience, we will use the file <code class="docutils literal notranslate"><span class="pre">sdss_galaxies_flux.parquet</span></code> which contains the <a class="reference external" href="https://skyserver.sdss.org/dr7/en/help/docs/algorithm.asp?key=mag_petro" rel="noreferrer" target="_blank">Petrosian magnitudes</a> in the Sloan filters for all the SDSS galaxies that have an associated redshift measurement (the redshift is given as the <code class="docutils literal notranslate"><span class="pre">z</span></code> column).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">galaxies</span> <span class="o">=</span> <span class="n">polars</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;sdss_galaxies_flux.parquet&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">galaxies</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Columns:&#39;</span><span class="p">,</span> <span class="n">galaxies</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>shape: (5, 13)
┌───────────┬───────────┬──────────┬───────────┬───┬───────────┬───────────┬───────────┬───────────┐
│ specobjid ┆ bestobjid ┆ z        ┆ petroflux ┆ … ┆ petromag_ ┆ petromag_ ┆ petromag_ ┆ petromag_ │
│ ---       ┆ ---       ┆ ---      ┆ _u        ┆   ┆ g         ┆ r         ┆ i         ┆ z         │
│ i64       ┆ i64       ┆ f64      ┆ ---       ┆   ┆ ---       ┆ ---       ┆ ---       ┆ ---       │
│           ┆           ┆          ┆ f64       ┆   ┆ f64       ┆ f64       ┆ f64       ┆ f64       │
╞═══════════╪═══════════╪══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 299489676 ┆ 123764872 ┆ 0.021275 ┆ 140.7772  ┆ … ┆ 15.614503 ┆ 14.845875 ┆ 14.443028 ┆ 14.131927 │
│ 975171584 ┆ 014240161 ┆          ┆           ┆   ┆           ┆           ┆           ┆           │
│           ┆ 1         ┆          ┆           ┆   ┆           ┆           ┆           ┆           │
│ 299489951 ┆ 123764872 ┆ 0.213925 ┆ 10.990943 ┆ … ┆ 18.665163 ┆ 17.663706 ┆ 17.293575 ┆ 17.19632  │
│ 853078528 ┆ 014253289 ┆          ┆           ┆   ┆           ┆           ┆           ┆           │
│           ┆ 1         ┆          ┆           ┆   ┆           ┆           ┆           ┆           │
│ 299490501 ┆ 123765079 ┆ 0.126554 ┆ 5.7761726 ┆ … ┆ 18.658691 ┆ 17.439886 ┆ 16.9439   ┆ 16.516115 │
│ 608892416 ┆ 514657603 ┆          ┆           ┆   ┆           ┆           ┆           ┆           │
│           ┆ 0         ┆          ┆           ┆   ┆           ┆           ┆           ┆           │
│ 299490776 ┆ 123765079 ┆ 0.448645 ┆ -0.357551 ┆ … ┆ 21.34879  ┆ 19.299929 ┆ 18.620996 ┆ 18.068316 │
│ 486799360 ┆ 514651090 ┆          ┆           ┆   ┆           ┆           ┆           ┆           │
│           ┆ 3         ┆          ┆           ┆   ┆           ┆           ┆           ┆           │
│ 299491601 ┆ 123765079 ┆ 0.090633 ┆ 21.535343 ┆ … ┆ 17.452871 ┆ 16.47817  ┆ 16.063156 ┆ 15.795011 │
│ 120520192 ┆ 460957409 ┆          ┆           ┆   ┆           ┆           ┆           ┆           │
│           ┆ 3         ┆          ┆           ┆   ┆           ┆           ┆           ┆           │
└───────────┴───────────┴──────────┴───────────┴───┴───────────┴───────────┴───────────┴───────────┘
Columns: [&#39;specobjid&#39;, &#39;bestobjid&#39;, &#39;z&#39;, &#39;petroflux_u&#39;, &#39;petroflux_g&#39;, &#39;petroflux_r&#39;, &#39;petroflux_i&#39;, &#39;petroflux_z&#39;, &#39;petromag_u&#39;, &#39;petromag_g&#39;, &#39;petromag_r&#39;, &#39;petromag_i&#39;, &#39;petromag_z&#39;]
</pre></div>
</div>
</div>
</div>
<p>We will plot the absolute i-band magnitude vs the g’-i’ colour. The absolute magnitude of a galaxy is often defined as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[M=m-\mu\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> is the <a class="reference external" href="https://en.wikipedia.org/wiki/Distance_modulus" rel="noreferrer" target="_blank">distance modulus</a>. For galaxies, the distance modulus can be computed from the redshift but we need to take into account the cosmological effects. To help us with that we will use the <code class="docutils literal notranslate"><span class="pre">astropy.cosmology</span></code> module, which provides a set of cosmological models and functions to compute distances and other cosmological quantities.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">astropy.cosmology</span><span class="w"> </span><span class="kn">import</span> <span class="n">FlatLambdaCDM</span>

<span class="c1"># Create our own cosmology model with some reasonable values.</span>
<span class="n">cosmo</span> <span class="o">=</span> <span class="n">FlatLambdaCDM</span><span class="p">(</span><span class="n">H0</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">Om0</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Compute the distance modulus for each galaxy</span>
<span class="n">d_mod</span> <span class="o">=</span> <span class="n">cosmo</span><span class="o">.</span><span class="n">distmod</span><span class="p">(</span><span class="n">galaxies</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>

<span class="c1"># Add the distance modulus to the dataframe</span>
<span class="n">galaxies</span> <span class="o">=</span> <span class="n">galaxies</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">d_mod</span><span class="o">=</span><span class="n">polars</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d_mod</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">polars</span><span class="o">.</span><span class="n">Float32</span><span class="p">))</span>

<span class="c1"># Compute the absolute i-band magnitude</span>
<span class="n">galaxies</span> <span class="o">=</span> <span class="n">galaxies</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">i_abs</span><span class="o">=</span><span class="n">polars</span><span class="o">.</span><span class="n">col</span><span class="o">.</span><span class="n">petromag_i</span> <span class="o">-</span> <span class="n">polars</span><span class="o">.</span><span class="n">col</span><span class="o">.</span><span class="n">d_mod</span><span class="p">)</span>

<span class="c1"># Add a column with the g&#39;-i&#39; colour</span>
<span class="n">galaxies</span> <span class="o">=</span> <span class="n">galaxies</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">g_i</span><span class="o">=</span><span class="n">polars</span><span class="o">.</span><span class="n">col</span><span class="o">.</span><span class="n">petromag_g</span> <span class="o">-</span> <span class="n">polars</span><span class="o">.</span><span class="n">col</span><span class="o">.</span><span class="n">petromag_i</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We could use all these data to plot the gCMD, but the result would not look very clear. The problem is that we have galaxies with very different redshifts, which means different stages in the galaxy evolution. We would also need to apply a <a class="reference external" href="https://en.wikipedia.org/wiki/K_correction" rel="noreferrer" target="_blank">K correction</a> to compare “apples to apples”. Instead, let’s focus on the local Universe and select only galaxies with a redshift below 0.05.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only galaxies with a redshift below 0.05</span>
<span class="n">local</span> <span class="o">=</span> <span class="n">galaxies</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">polars</span><span class="o">.</span><span class="n">col</span><span class="o">.</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of galaxies: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">local</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of galaxies: 123026
</pre></div>
</div>
</div>
</div>
<p>Time to do some plotting! We will start with a simple scatter plot of the absolute i-band magnitude vs the g’-i’ colour.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seaborn</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">local</span><span class="p">[</span><span class="s1">&#39;i_abs&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">local</span><span class="p">[</span><span class="s1">&#39;g_i&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a383702947f1b224a98ba29a8f28a0daeb5769143443646b687ad2545bf54664.png" src="../../_images/a383702947f1b224a98ba29a8f28a0daeb5769143443646b687ad2545bf54664.png" />
</div>
</div>
<p>This doesn’t look very promising. The problem is that we have a few outliers that are skewing the plot. Let’s remove those outliers by selecting only galaxies with an absolute magnitude between -25 and -16, and a g’-i’ colour between 0 and 2. You can play with these values to see how they affect the plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">local</span> <span class="o">=</span> <span class="n">local</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">polars</span><span class="o">.</span><span class="n">col</span><span class="o">.</span><span class="n">i_abs</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">25</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">polars</span><span class="o">.</span><span class="n">col</span><span class="o">.</span><span class="n">i_abs</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">polars</span><span class="o">.</span><span class="n">col</span><span class="o">.</span><span class="n">g_i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">polars</span><span class="o">.</span><span class="n">col</span><span class="o">.</span><span class="n">g_i</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">local</span><span class="p">[</span><span class="s1">&#39;i_abs&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">local</span><span class="p">[</span><span class="s1">&#39;g_i&#39;</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Absolute i-band magnitude&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;g</span><span class="se">\&#39;</span><span class="s1">-i</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/40f3cf4db68659cd855993714519700b458d67bee880ef93b8049b57069a7d59.png" src="../../_images/40f3cf4db68659cd855993714519700b458d67bee880ef93b8049b57069a7d59.png" />
</div>
</div>
<p>That is significantly better, but the cloud of points is so large that it’s difficult to see any details of the underlying distribution. Let’s use a 2D histogram to plot the density of the points in the gCMD. We will use the <code class="docutils literal notranslate"><span class="pre">seaborn.histplot</span></code> function with the <code class="docutils literal notranslate"><span class="pre">cbar</span></code> parameter to add a colour bar that shows the density of the points. We will also use the <code class="docutils literal notranslate"><span class="pre">pthresh</span></code> parameter to remove points with a density below a certain threshold.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">local</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;i_abs&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;g_i&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">pthresh</span><span class="o">=</span><span class="mf">.01</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;mako&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Absolute i-band magnitude&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;g</span><span class="se">\&#39;</span><span class="s1">-i</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d9f7e004d50bf8bbc66897a421eecc961ee5f226c7f5af01199beaad419c02a4.png" src="../../_images/d9f7e004d50bf8bbc66897a421eecc961ee5f226c7f5af01199beaad419c02a4.png" />
</div>
</div>
<p>That is much better. We can clearly see the blue and red clouds. Note that we have reversed the x-axis so that increasing stellar mass (decreasing absolute magnitude) is on the right side of the plot. Alternatively we could use a KDE to plot the density of the points in the gCMD.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the cloud of points in the background</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">local</span><span class="p">[</span><span class="s1">&#39;i_abs&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">local</span><span class="p">[</span><span class="s1">&#39;g_i&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># Plot the KDE contours. The compute time will depend on the number of bins.</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">local</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;i_abs&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;g_i&#39;</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">gridsize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Absolute i-band magnitude&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;g</span><span class="se">\&#39;</span><span class="s1">-i</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/dae55f2d57856ae0a81e337cb08d3c77e77dae095e7789cc9b6504b4734ad274.png" src="../../_images/dae55f2d57856ae0a81e337cb08d3c77e77dae095e7789cc9b6504b4734ad274.png" />
</div>
</div>
<p>Finally, let’s plot the same data using filled contours.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">local</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;i_abs&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;g_i&#39;</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">gridsize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;mako&#39;</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Absolute i-band magnitude&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;g</span><span class="se">\&#39;</span><span class="s1">-i</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="o">-</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9cddd71a466a9faaa344cab85a5c863d18f52936dfccc4e8f594369b9d66956d.png" src="../../_images/9cddd71a466a9faaa344cab85a5c863d18f52936dfccc4e8f594369b9d66956d.png" />
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../spectrographs/spectrographs.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Spectrographs</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../catalogue_data/catalogue_data.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Catalogue data and SQL</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025-, José Sánchez-Gallego
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/uw-astro-480/uw-astro-480.github.io/" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Plotting and data visualisation</a><ul>
<li><a class="reference internal" href="#types-of-plots">Types of plots</a><ul>
<li><a class="reference internal" href="#scatter-plots">Scatter plots</a></li>
<li><a class="reference internal" href="#line-plots">Line plots</a></li>
<li><a class="reference internal" href="#histograms-and-kde">Histograms and KDE</a></li>
<li><a class="reference internal" href="#bar-plots">Bar plots</a></li>
<li><a class="reference internal" href="#bivariate-distributions">Bivariate distributions</a></li>
<li><a class="reference internal" href="#violin-and-box-plots">Violin and box plots</a></li>
<li><a class="reference internal" href="#multigrid-plots">Multigrid plots</a></li>
<li><a class="reference internal" href="#images">Images</a></li>
</ul>
</li>
<li><a class="reference internal" href="#colours-and-palettes">Colours and palettes</a></li>
<li><a class="reference internal" href="#displaying-astronomical-images">Displaying astronomical images</a><ul>
<li><a class="reference internal" href="#creating-rgb-images">Creating RGB images</a></li>
</ul>
</li>
<li><a class="reference internal" href="#plotting-tabular-data">Plotting tabular data</a></li>
<li><a class="reference internal" href="#plotting-a-galaxy-colour-magnitude-diagram">Plotting a galaxy colour-magnitude diagram</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=df1a032d"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>